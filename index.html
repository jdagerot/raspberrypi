<!DOCTYPE html>
<html lang="">
	<head>
		<title>Title Page</title>
		<meta charset="UTF-8">
		<meta name=description content="">
		<meta name=viewport content="width=device-width, initial-scale=1">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<!-- Bootstrap CSS -->
		<link href="//netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css" rel="stylesheet" media="screen">
	</head>
	<body>
		<h1 class="text-center">Toggle LEDs</h1>

		<ul id="lampsList">

		</ul>
		<!-- jQuery -->
		<script src="//code.jquery.com/jquery.js"></script>
		<!-- Bootstrap JavaScript -->
		<script src="//netdna.bootstrapcdn.com/bootstrap/3.1.0/js/bootstrap.min.js"></script>
		<script src="/socket.io/socket.io.js"></script>
		<script>
			var socket = io();
			var lamps = [
				{color:"Green", pin:13},
				{color:"Red", pin:11},
				{color:"Blue", pin:7}
			];

			// WriteUp

			$.each(lamps, function(idx,lamp) {
				$("#lampsList").append(
'					<li>'
+'						<span data-pin="' + lamp.pin + '" data-color="' + lamp.color + '" class="button">Toggle ' + lamp.color + '</button>'
+'						<span class="state"></span>'
+'					</li>'
				);
			});

			$("#lampsList > li > span.button").click(function(){
				var $this = $(this);
				var pin = $this.attr("data-pin");
				console.log(pin);
				socket.emit('ToggleLamp', pin);
			});

			socket.on("status", function(args){

				var obj = $("span[data-pin='" + args.pin + "']");
				obj.html("Toggle " + obj.attr("data-color") + ": " + args.state);
				console.log("status change");
				console.log(args);

			});

			$("#test").click(function(){
				console.log("Clicking");
				socket.emit('ToggleLamp', 13);
				return false;
			});

		</script>

	</body>
</html>